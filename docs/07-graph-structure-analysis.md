# Структурный анализ графа сети

Версия документа: 1.0  
Последнее обновление: 9 февраля 2026 г.  

## Назначение анализа

Структурный анализ графа предоставляет количественные и качественные метрики топологии сети для оценки её свойств и характеристик. Анализ выполняется автоматически при выборе графа в интерфейсе и отображает результаты в виде числовых показателей и матриц.

Основные задачи анализа:
- Оценка связности и целостности сети
- Выявление циклов и потенциальных петель маршрутизации
- Расчёт метрик плотности и диаметра для оценки эффективности топологии
- Определение центральных узлов для понимания критических точек сети
- Формирование матриц смежности и инцидентности для визуализации и внешних инструментов

Анализ не влияет на синтез конфигураций — он предназначен исключительно для информационной поддержки пользователя и отладки топологии.

## Вычисляемые метрики

### Базовые метрики

Количество вершин (VertexCount) — общее число уникальных узлов в сети, включая изолированные узлы из свойства AllNetworkNodes.

Количество рёбер (EdgeCount) — общее число связей в графе, независимо от направления.

Количество направленных рёбер (DirectedLinksCount) — число связей с заданным направлением (правые или левые).

Количество ненаправленных рёбер (UndirectedLinksCount) — число связей без направления (ненаправленные).

### Топологические свойства

Связность (IsConnected) — булево значение, указывающее, является ли граф связным (все узлы достижимы друг из друга). Для ориентированных графов проверяется слабая связность (игнорирование направлений).

Наличие циклов (HasCycles) — булево значение, указывающее на существование циклов в графе. Важно для выявления потенциальных петель маршрутизации.

Плотность (Density) — отношение фактического числа рёбер к максимально возможному. Для неориентированного графа с n вершинами максимум рёбер = n(n-1)/2. Плотность близкая к 1 означает почти полносвязную сеть, близкая к 0 — разреженную топологию.

Диаметр (Diameter) — максимальное расстояние (в рёбрах) между любой парой вершин в графе. Характеризует максимальную задержку маршрутизации в сети.

Количество сильно связных компонент (StronglyConnectedComponentsCount) — число компонент, в которых любая вершина достижима из любой другой с учётом направлений рёбер. Для неориентированных графов совпадает с числом компонент связности.

### Метрики центральности

Степень центральности (DegreeCentrality) — нормализованная мера количества связей узла. Высокая степень центральности указывает на узел-концентратор, критический для связности сети.

Посредническая центральность (BetweennessCentrality) — мера того, насколько часто узел лежит на кратчайших путях между другими парами узлов. Узлы с высокой посреднической центральностью являются критическими точками маршрутизации.

## Матричное представление

### Матрица смежности

Квадратная матрица размером N×N, где N — количество узлов. Элемент [i, j] равен 1, если существует связь от узла i к узлу j, и 0 в противном случае. Для ненаправленных связей заполняются оба элемента [i, j] и [j, i]. Матрица используется для визуализации связей и анализа спектральных свойств графа.

### Матрица инцидентности

Прямоугольная матрица размером N×M, где N — количество узлов, M — количество рёбер. Элемент [i, j] равен:
- 1 — если узел является конечной точкой ребра (для ненаправленных рёбер)
- -1 и 1 — для начала и конца направленного ребра соответственно
- 0 — если узел не инцидентен ребру

Матрица инцидентности полезна для алгоритмов, работающих с рёбрами напрямую (например, потоковые алгоритмы).

## Алгоритмы вычисления

Все метрики вычисляются с использованием классических алгоритмов теории графов:

Связность — поиск в глубину (DFS) из произвольной вершины с подсчётом посещённых узлов. Если посещены все узлы — граф связен.

Циклы — модифицированный DFS с отслеживанием стека рекурсии для выявления обратных рёбер.

Плотность — простое отношение фактического числа рёбер к теоретическому максимуму для данного числа вершин.

Диаметр — алгоритм Флойда-Уоршелла для нахождения всех кратчайших путей с последующим выбором максимального расстояния.

Степень центральности — подсчёт связей для каждого узла с нормализацией на (n-1).

Посредническая центральность — алгоритм Брандеса, выполняющий поиск кратчайших путей из каждой вершины и подсчитывающий долю путей, проходящих через каждый узел.

Сильно связные компоненты — алгоритм Косарайю с двойным проходом DFS (прямой граф и транспонированный).

## Интеграция в систему

Структурный анализ реализован как доменный сервис IGraphAnalysisDomainService без зависимостей от инфраструктуры. Сценарий использования AnalyzeGraphStructureUseCase координирует вызов сервиса и преобразование результатов в DTO для отображения в интерфейсе.

Анализ выполняется синхронно при выборе графа в интерфейсе. Для графов реального размера (до нескольких тысяч узлов) время вычисления не превышает 100-200 миллисекунд.

Результаты анализа отображаются на вкладке "Анализ" главного окна и включают:
- Числовые метрики в виде таблицы
- Визуализацию матрицы смежности с цветовой индикацией
- Визуализацию матрицы инцидентности
- Информацию о центральных узлах

## Практическое применение

Хотя структурный анализ не участвует напрямую в синтезе конфигураций, он полезен для:

1. Отладки топологии сети
   - Выявление изолированных узлов или компонент
   - Обнаружение неожиданных циклов в маршрутизации
   - Проверка целостности импортированных графов

2. Оценки качества топологии
   - Анализ плотности для выявления избыточных или недостаточных связей
   - Оценка диаметра для понимания максимальных задержек
   - Выявление критических узлов через метрики центральности

3. Подготовки данных для внешних инструментов
   - Экспорт матриц для анализа в специализированных системах
   - Использование метрик в отчётах и документации

4. Обучения и демонстрации
   - Визуализация свойств графов для понимания топологии
   - Сравнение различных вариантов топологии по метрикам

## Ограничения

Анализ работает только с текущим временным графом, не учитывая динамику во времени. Для анализа временной эволюции топологии необходимо выполнять анализ для каждого интервала отдельно и сравнивать результаты вручную.

Метрики центральности вычисляются для статического графа без учёта пропускной способности связей или нагрузки на узлы. Для анализа производительности сети требуются дополнительные инструменты моделирования трафика.

Алгоритмы оптимизированы для графов среднего размера (до 5000 узлов). Для очень крупных графов возможны ограничения по времени вычисления и потреблению памяти.

## Заключение

Структурный анализ графа — вспомогательный, но полезный компонент системы, предоставляющий пользователю объективную информацию о свойствах топологии сети. Анализ основан на классических алгоритмах теории графов, полностью изолирован от бизнес-логики синтеза и не влияет на результаты конфигурирования сети. Его основная ценность — информационная поддержка при проектировании и отладке топологии динамической сети.